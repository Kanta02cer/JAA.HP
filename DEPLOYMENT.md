# JAA.HP ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰

## ğŸš€ Firebase Functions ã®ãƒ‡ãƒ—ãƒ­ã‚¤

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
cd firebase/functions
npm install
```

### 2. Firebase Functions ã®ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
cd firebase
firebase deploy --only functions
```

### 3. ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèª
ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š
```
âœ”  functions[getNews(asia-northeast1)] Successful create operation. 
âœ”  functions[getNewsById(asia-northeast1)] Successful create operation. 
âœ”  functions[sendVerificationEmail(asia-northeast1)] Successful create operation. 
```

## ğŸŒ GitHub Pages ã§ã®å‹•ä½œç¢ºèª

### 1. å¤‰æ›´ã‚’GitHubã«ãƒ—ãƒƒã‚·ãƒ¥
```bash
git add .
git commit -m "Add Firebase Functions API for news loading"
git push origin main
```

### 2. å‹•ä½œç¢ºèªæ‰‹é †

#### ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
1. F12ã‚­ãƒ¼ã‚’æŠ¼ã™
2. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¿ãƒ–ã‚’é¸æŠ

#### æœŸå¾…ã•ã‚Œã‚‹ãƒ­ã‚°å‡ºåŠ›
```
DOMèª­ã¿è¾¼ã¿å®Œäº† - ãƒ‹ãƒ¥ãƒ¼ã‚¹èª­ã¿è¾¼ã¿é–‹å§‹
Firebase Functions APIæ¥ç¶šæˆåŠŸ - ãƒ‹ãƒ¥ãƒ¼ã‚¹èª­ã¿è¾¼ã¿é–‹å§‹
ãƒ‹ãƒ¥ãƒ¼ã‚¹èª­ã¿è¾¼ã¿é–‹å§‹: news-list-home, æœ€å¤§ä»¶æ•°: 5
å–å¾—ã—ãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ä»¶æ•°: X
ãƒ‹ãƒ¥ãƒ¼ã‚¹è¡¨ç¤ºå®Œäº†: news-list-home
```

#### ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å‡¦æ³•

**CORSã‚¨ãƒ©ãƒ¼ã®å ´åˆ:**
- Firebase Functionsã®ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
- ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆ

**APIæ¥ç¶šã‚¨ãƒ©ãƒ¼ã®å ´åˆ:**
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®çŠ¶æ³ã‚’ç¢ºèª
- Firebase Functionsã®ãƒ­ã‚°ã‚’ç¢ºèª

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Firebase Functions ãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œãªã„å ´åˆ
```bash
# Firebase CLIã®ãƒ­ã‚°ã‚¤ãƒ³ç¢ºèª
firebase login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¢ºèª
firebase projects:list

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é¸æŠ
firebase use jaa-hp

# å†ãƒ‡ãƒ—ãƒ­ã‚¤
firebase deploy --only functions
```

### APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ç¢ºèª
ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€ä»¥ä¸‹ã®URLã§APIãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ï¼š
- ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§: `https://asia-northeast1-jaa-hp.cloudfunctions.net/getNews`
- ç‰¹å®šè¨˜äº‹: `https://asia-northeast1-jaa-hp.cloudfunctions.net/getNewsById/{id}`

### ãƒ†ã‚¹ãƒˆç”¨ã®cURLã‚³ãƒãƒ³ãƒ‰
```bash
# æœ€æ–°5ä»¶ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—
curl "https://asia-northeast1-jaa-hp.cloudfunctions.net/getNews?limit=5"

# å…¨ä»¶å–å¾—
curl "https://asia-northeast1-jaa-hp.cloudfunctions.net/getNews"
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
Firebase Functionsã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®šã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹åŒ–ï¼š
```javascript
res.set('Cache-Control', 'public, max-age=300'); // 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
```

### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã®å†è©¦è¡Œæ©Ÿèƒ½
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤ºã®å®Ÿè£…
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š

### 1. CORSè¨­å®š
ç¾åœ¨ã¯å…¨ã¦ã®ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¦ã„ã¾ã™ãŒã€æœ¬ç•ªç’°å¢ƒã§ã¯åˆ¶é™ã‚’æ¤œè¨ï¼š
```javascript
const cors = require('cors')({ 
  origin: ['https://kanta02cer.github.io', 'https://localhost:3000'] 
});
```

### 2. ãƒ¬ãƒ¼ãƒˆåˆ¶é™
å¿…è¦ã«å¿œã˜ã¦ã€APIå‘¼ã³å‡ºã—å›æ•°ã®åˆ¶é™ã‚’å®Ÿè£…ï¼š
```javascript
// 1åˆ†é–“ã«æœ€å¤§100å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
const rateLimit = require('express-rate-limit');
```

## ğŸ“ ä»Šå¾Œã®æ”¹å–„ç‚¹

1. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã®å¼·åŒ–**
   - Redisç­‰ã‚’ä½¿ç”¨ã—ãŸã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€é©åŒ–

2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**
   - WebSocketã‚’ä½¿ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡
   - ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥æ©Ÿèƒ½

3. **SEOæœ€é©åŒ–**
   - ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
   - ãƒ¡ã‚¿ã‚¿ã‚°ã®å‹•çš„ç”Ÿæˆ

4. **ç›£è¦–ãƒ»ãƒ­ã‚°**
   - Firebase Functionsã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
   - ã‚¨ãƒ©ãƒ¼ç‡ã®è¿½è·¡
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•ã®åˆ†æ
